generator client {
  provider        = "cargo prisma"
  output          = "../src/db.rs"
  module_path     = "db"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  url        = env("DATABASE_URL")
  extensions = [citext(schema: "public")]
}

model User {
  id        String   @id @default(uuid()) @db.Uuid
  createdAt DateTime @default(now())

  username   String @unique @db.Citext
  access_key String

  images  Image[]
  folders Folder[]
  role    Role     @default(USER)
}

model Image {
  id        String   @id @default(uuid()) @db.Uuid
  createdAt DateTime @default(now())

  fileId   String  @unique @db.Citext
  favorite Boolean @default(false)

  user   User   @relation(fields: [userId], references: [id])
  userId String @db.Uuid

  folder   Folder? @relation(fields: [folderId], references: [id])
  folderId String? @db.Uuid

  tags Tag[]
}

model Folder {
  id        String   @id @default(uuid()) @db.Uuid
  createdAt DateTime @default(now())

  name        String  @db.Citext
  description String?
  pinned      Boolean @default(false)

  user   User   @relation(fields: [userId], references: [id])
  userId String @db.Uuid

  images Image[]
}

model Tag {
  id     String  @id @default(uuid()) @db.Uuid
  name   String  @unique @db.Citext
  images Image[]
}

enum Role {
  USER
  ADMIN
}
